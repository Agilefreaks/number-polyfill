(function(){(function(e){var t,n;return t=document.createElement("input"),t.setAttribute("type","number"),"text"!==t.type?(e.fn.inputNumber=function(){return e(this)},void 0):(e.fn.inputNumber=function(){return console.log("found "+e(this).filter('input[type="number"]').length+" elements."),e(this).filter('input[type="number"]').each(function(){console.log("Creating new polyfill."),n.polyfills.push(new n(this))}),e(this)},n=function(t){var n,i,s,o,l,r,a,u=this;this.elem=e(t),r=this.elem.outerHeight()/2+"px",this.upBtn=e("<div/>",{"class":"number-spin-btn number-spin-btn-up",style:"height: "+r}),this.downBtn=e("<div/>",{"class":"number-spin-btn number-spin-btn-down",style:"height: "+r}),n=e("<div/>",{"class":"number-spin-btn-container"}),i=e("<span/>",{style:"white-space: nowrap"}),this.upBtn.appendTo(n),this.downBtn.appendTo(n),this.elem.wrap(i),n.insertAfter(this.elem),console.log("Added buttons."),l=function(e){e.preventDefault(),0>e.originalEvent.detail?u.increment():u.decrement()},a=function(e){e.preventDefault(),e.originalEvent.wheelDelta>0?u.increment():u.decrement()},console.log("Adding element event handlers."),this.elem.on({focus:function(){u.elem.on({DOMMouseScroll:l,mousewheel:a})},blur:function(){u.elem.off({DOMMouseScroll:l,mousewheel:a})},keypress:function(e){var t,n;38===e.keyCode?u.increment():40===e.keyCode?u.decrement():8!==(t=e.keyCode)&&9!==t&&35!==t&&36!==t&&37!==t&&39!==t&&45!==(n=e.which)&&46!==n&&48!==n&&49!==n&&50!==n&&51!==n&&52!==n&&53!==n&&54!==n&&55!==n&&56!==n&&57!==n&&e.preventDefault()},change:function(e){var t,n;null!=e.originalEvent&&(n=u.getParams(),t=u.clipValues(n.val,n.min,n.max),t=u.matchStep(t,n.min,n.max,n.step,n.stepDecimal),u.elem.val(t))}}),console.log("Adding button event handlers."),this.upBtn.on("mousedown",function(){var t,n;u.increment(),n=function(){u.increment(),u.timeoutID=window.setTimeout(n,10)},t=function(){window.clearTimeout(u.timeoutID),e(document).off("mouseup",t),u.upBtn.off("mouseleave",t)},e(document).on("mouseup",t),u.upBtn.on("mouseleave",t),u.timeoutID=window.setTimeout(n,700)}),this.downBtn.on("mousedown",function(){var t,n;u.decrement(),n=function(){u.decrement(),u.timeoutID=window.setTimeout(n,10)},t=function(){window.clearTimeout(u.timeoutID),e(document).off("mouseup",t),u.downBtn.off("mouseleave",t)},e(document).on("mouseup",t),u.downBtn.on("mouseleave",t),u.timeoutID=window.setTimeout(n,700)}),this.elem.css("textAlign","right"),"1"!==this.elem.css("opacity")&&n.css("opacity",this.elem.css("opacity")),"visible"!==this.elem.css("visibility")&&n.css("visibility",this.elem.css("visibility")),console.log("Adding mutation observers."),"undefined"!=typeof WebKitMutationObserver&&null!==WebKitMutationObserver||"undefined"!=typeof MutationObserver&&null!==MutationObserver?(s=function(e){var t,i,s;for(i=0,s=e.length;s>i;i++)t=e[i],"attributes"===t.type&&("class"===t.attributeName?n.removeClass(t.oldValue).addClass(u.elem.className):"style"===t.attributeName&&n.css({opacity:u.elem.css("opacity"),visibility:u.elem.css("visibility"),display:u.elem.css("display")}))},o="undefined"!=typeof WebKitMutationObserver&&null!==WebKitMutationObserver?new WebKitMutationObserver(s):"undefined"!=typeof MutationObserver&&null!==MutationObserver?new MutationObserver(s):null,o.observe(t,{attributes:!0,attributeOldValue:!0,attributeFilter:["class","style"]})):"undefined"!=typeof MutationEvent&&null!==MutationEvent&&this.elem.on("DOMAttrModified",function(n){"class"===n.originalEvent.attrName?e(btnContainer).removeClass(n.originalEvent.prevValue).addClass(n.originalEvent.newValue):"style"===n.originalEvent.attrName&&e(btnContainer).css({display:t.style.display,visibility:t.style.visibility,opacity:t.style.opacity})}),console.log("Done with one.")},n.polyfills=[],n.prototype.getParams=function(){var e,t,n,i;return n=this.elem.attr("step"),t=this.elem.attr("min"),e=this.elem.attr("max"),i=this.elem.val(),/^-?\d+(?:\.\d+)?$/.test(n)||(n=null),/^-?\d+(?:\.\d+)?$/.test(t)||(t=null),/^-?\d+(?:\.\d+)?$/.test(e)||(e=null),/^-?\d+(?:\.\d+)?$/.test(i)||(i=t||0),{min:t,max:e,step:n,val:i}},n.prototype.clipValues=function(e,t,n){return null!=n&&e>n?n:null!=t&&t>e?t:e},n.extractNumDecimalDigits=function(e){var t,n;return t=/^-?\d+\.\d+$/,n=/^-?\d+$/,t.test(e)?/^-?\d+\.(\d+)$/.exec(e)[1].length:n.test(e)?0:void 0},n.prototype.stepNormalize=function(e){return e},n.addAsStr=function(e,i){var s,o,l,r,a,u,m,c,d,p,f,h,v,b,y,g;if(u=/^-?\d+(?:\.\d+)?$/,m=/^-?\d+$/,c=/^-.+$/,u.test(e)&&u.test(i)){if(m.test(e))return m.test(i)?""+(parseInt(e,10)+parseInt(i,10)):n.addAsStr(e+".0",i);if(m.test(i))return n.addAsStr(e,i+".0");if(f=e.length-e.indexOf(".")-1,h=i.length-i.indexOf(".")-1,s=!0,p="",d=0,o=0,l=0,h>f)for(t=v=0,y=h-f;y>=0?y>v:v>y;t=y>=0?++v:--v)e+="0";else if(f>h)for(t=b=0,g=f-h;g>=0?g>b:b>g;t=g>=0?++b:--b)i+="0";for((c.test(e)&&!c.test(i)||!c.test(e)&&c.test(i))&&(s=!1);e.length>d&&i.length>d||0!==o;)r=e.length>d?e[e.length-1-d]:"0",a=i.length>d?i[i.length-1-d]:"0","-"===r&&(r="0"),"-"===a&&(a="0"),"."===r&&"."===a?p="."+p:(r=parseInt(r,10),a=parseInt(a,10),l=s?r+a+o:r-a-o,o=Math.floor(l/10),p=""+l%10+p),d++;return c.test(e)?(c.test(i)||parseInt(i,10)<Math.abs(parseInt(e,10)))&&(p="-"+p):c.test(i)&&Math.abs(parseInt(i,10))>parseInt(e,10)&&(p="-"+p),p}},n.subtractAsStr=function(e,t){var i;return i=/^-.+$/,i.test(t)?n.addAsStr(e,t.slice(1)):n.addAsStr(e,"-"+t)},n.prototype.increment=function(){var e,t;this.elem.is(":disabled")||(console.log("increment() called."),t=this.getParams(),e=n.addAsStr(t.val,t.step),null!=t.max&&parseFloat(e)>parseFloat(t.max)&&(e=t.max),e=this.stepNormalize(e),this.elem.val(e).change())},n.prototype.decrement=function(){var e,t;this.elem.is(":disabled")||(console.log("decrement() called."),t=this.getParams(),e=n.subtractAsStr(t.val,t.step),null!=t.min&&parseFloat(e)<parseFloat(t.min)&&(e=t.min),e=this.stepNormalize(e),this.elem.val(e).change())},e(function(){e('input[type="number"]').inputNumber()}),void 0)})(jQuery)}).call(this);