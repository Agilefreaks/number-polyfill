(function(){!function(e){var n,t;return(n=function(){var e,n;return e=document.createElement("input"),e.setAttribute("type","number"),n="123foo",e.value=n,e.value===n})()?(e.fn.inputNumber=function(){return e(this).filter(function(){var n;return n=e(this),n.is('input[type="number"]')&&!(n.parent().is("span")&&n.next().is("div.number-spin-btn-container")&&n.next().children().first().is("div.number-spin-btn-up")&&n.next().children().eq(1).is("div.number-spin-btn-down"))}).each(function(){t.polyfills.push(new t(this))}),e(this)},t=function(n){var i,r,o;this.elem=e(n),this.upBtn=e("<div/>",{"class":"number-spin-btn number-spin-btn-up"}),this.downBtn=e("<div/>",{"class":"number-spin-btn number-spin-btn-down"}),this.btnContainer=e("<div/>",{"class":"number-spin-btn-container"}),i=e("<span/>"),this.upBtn.appendTo(this.btnContainer),this.downBtn.appendTo(this.btnContainer),this.elem.wrap(i),this.btnContainer.insertAfter(this.elem),this.elem.on({focus:function(e){return function(n){e.elem.on({DOMMouseScroll:t.domMouseScrollHandler,mousewheel:t.mouseWheelHandler},{p:e})}}(this),blur:function(e){return function(n){e.elem.off({DOMMouseScroll:t.domMouseScrollHandler,mousewheel:t.mouseWheelHandler})}}(this)}),this.elem.on({keypress:t.elemKeypressHandler,change:t.elemChangeHandler},{p:this}),this.upBtn.on("mousedown",{p:this,func:"increment"},t.elemBtnMousedownHandler),this.downBtn.on("mousedown",{p:this,func:"decrement"},t.elemBtnMousedownHandler),this.attrMutationHandler("class"),"undefined"!=typeof WebKitMutationObserver&&null!==WebKitMutationObserver||"undefined"!=typeof r&&null!==r?("undefined"==typeof WebKitMutationObserver||null===WebKitMutationObserver||"undefined"!=typeof r&&null!==r||(r=WebKitMutationObserver),o=new r(function(e){return function(n,t){var i,r,o;for(i=0,r=n.length;r>i;i++)o=n[i],"attributes"===o.type&&e.attrMutationHandler(o.attributeName,o.oldValue,e.elem.attr(o.attributeName))}}(this)),o.observe(n,{attributes:!0,attributeOldValue:!0,attributeFilter:["class","style","min","max","step"]})):"undefined"!=typeof MutationEvent&&null!==MutationEvent&&this.elem.on("DOMAttrModified",function(e){return function(n){e.attrMutationHandler(n.originalEvent.attrName,n.originalEvent.prevValue,n.originalEvent.newValue)}}(this))},t.polyfills=[],t.isNumber=function(e){return null!=e&&"function"==typeof e.toString?/^-?\d+(?:\.\d+)?$/.test(e.toString()):!1},t.isFloat=function(e){return null!=e&&"function"==typeof e.toString?/^-?\d+\.\d+$/.test(e.toString()):!1},t.isInt=function(e){return null!=e&&"function"==typeof e.toString?/^-?\d+$/.test(e.toString()):!1},t.isNegative=function(e){return null!=e&&"function"==typeof e.toString?/^-\d+(?:\.\d+)?$/.test(e.toString()):!1},t.raiseNum=function(e){var n,i,r;if("number"==typeof e||"object"==typeof e&&e instanceof Number)return e%1?{num:e.toString(),precision:0}:t.raiseNum(e.toString());if("string"==typeof e||"object"==typeof e&&e instanceof String){if(t.isFloat(e))return e=e.replace(/(\.\d)0+$/,"$1"),r=t.getPrecision(e),i=e.slice(0,-(r+1))+e.slice(-r),i=i.replace(/^(-?)0+(\d+)/,"$1$2"),n={num:i,precision:r};if(t.isInt(e))return{num:e,precision:0}}},t.raiseNumPrecision=function(e,n){var t,i,r,o;if(e.precision<n){for(t=i=r=e.precision,o=n;o>=r?o>i:i>o;t=o>=r?++i:--i)e.num+="0";e.precision=n}},t.lowerNum=function(e){if(e.precision>0){for(;e.num.length<e.precision+1;)t.isNegative(e.num)?e.num=e.num.slice(0,1)+"0"+e.num.slice(1):e.num="0"+e.num;return(e.num.slice(0,-e.precision)+"."+e.num.slice(-e.precision)).replace(/\.?0+$/,"").replace(/^(-?)(\.)/,"$10$2")}return e.num},t.preciseAdd=function(e,n){var i,r,o;if(("number"==typeof e||"object"==typeof e&&e instanceof Number)&&("number"==typeof n||"object"==typeof n&&n instanceof Number))return e%1===0&&n%1===0?(e+n).toString():t.preciseAdd(e.toString(),n.toString());if(("string"==typeof e||"object"==typeof e&&e instanceof String)&&("string"==typeof n||"object"==typeof n&&n instanceof String)){if(t.isNumber(e)){if(t.isNumber(n)){if(t.isInt(e)){if(t.isInt(n))return t.preciseAdd(parseInt(e,10),parseInt(n,10));t.isFloat(n)&&(e+=".0")}else t.isFloat(e)&&t.isInt(n)&&(n+=".0");if(i=t.raiseNum(e),r=t.raiseNum(n),i.precision<r.precision?t.raiseNumPrecision(i,r.precision):i.precision>r.precision&&t.raiseNumPrecision(r,i.precision),o=(parseInt(i.num,10)+parseInt(r.num,10)).toString(),i.precision>0){if(t.isNegative(o))for(;i.precision>o.length-1;)o="-0"+o.slice(1);else for(;i.precision>o.length;)o="0"+o;o=t.lowerNum({num:o,precision:i.precision})}return o=o.replace(/^(-?)\./,"$10."),t.isFloat(o)&&(o=o.replace(/0+$/,"")),o}throw new SyntaxError('Argument "'+n+'" is not a number.')}throw new SyntaxError('Argument "'+e+'" is not a number.')}return t.preciseAdd(e.toString(),n.toString())},t.preciseSubtract=function(e,n){return"number"==typeof n||"object"==typeof n&&n instanceof Number?t.preciseAdd(e,-n):"string"==typeof n||"object"==typeof n&&n instanceof String?t.isNegative(n)?t.preciseAdd(e,n.slice(1)):t.preciseAdd(e,"-"+n):void 0},t.getPrecision=function(e){var n,i;if("number"==typeof e){for(n=0,i=e;i!==Math.floor(i);)i=e*Math.pow(10,++n);return n}return"string"==typeof e&&t.isNumber(e)?t.isFloat(e)?/^-?\d+(?:\.(\d+))?$/.exec(e)[1].length:0:void 0},t.prototype.getParams=function(){var e,n,i,r;return i=this.elem.attr("step"),n=this.elem.attr("min"),e=this.elem.attr("max"),r=this.elem.val(),t.isNumber(i)||(i=null),t.isNumber(n)||(n=null),t.isNumber(e)||(e=null),t.isNumber(r)||(r=n||0),{min:null!=n?n:null,max:null!=e?e:null,step:null!=i?i:"1",val:null!=r?r:null}},t.prototype.clipValues=function(e,n,t){return null!=t&&parseFloat(e)>parseFloat(t)?t:null!=n&&parseFloat(e)<parseFloat(n)?n:e},t.prototype.stepNormalize=function(e){var n,i,r,o,s;return r=this.getParams(),s=r.step,i=r.min,null==s?e:(s=t.raiseNum(s),n=t.raiseNum(e),n.precision>s.precision?t.raiseNumPrecision(s,n.precision):n.precision<s.precision&&t.raiseNumPrecision(n,s.precision),null!=i&&(n=t.raiseNum(t.preciseSubtract(e,i)),t.raiseNumPrecision(n,s.precision)),parseFloat(n.num)%parseFloat(s.num)===0?e:(n=t.lowerNum({num:(Math.round(parseFloat(n.num)/(o=parseFloat(s.num)))*o).toString(),precision:n.precision}),null!=i&&(n=t.preciseAdd(n,i)),n))},t.domMouseScrollHandler=function(e){var n;n=e.data.p,e.preventDefault(),e.originalEvent.detail<0?n.increment():n.decrement()},t.mouseWheelHandler=function(e){var n;n=e.data.p,e.preventDefault(),e.originalEvent.wheelDelta>0?n.increment():n.decrement()},t.elemKeypressHandler=function(e){var n,t,i;n=e.data.p,38===e.keyCode?n.increment():40===e.keyCode?n.decrement():8!==(t=e.keyCode)&&9!==t&&35!==t&&36!==t&&37!==t&&39!==t&&46!==t&&45!==(i=e.which)&&46!==i&&48!==i&&49!==i&&50!==i&&51!==i&&52!==i&&53!==i&&54!==i&&55!==i&&56!==i&&57!==i&&e.preventDefault()},t.elemChangeHandler=function(e){var n,i,r,o;r=e.data.p,""!==r.elem.val()&&(t.isNumber(r.elem.val())?(o=r.getParams(),i=r.clipValues(o.val,o.min,o.max),i=r.stepNormalize(i),i.toString()!==r.elem.val()&&r.elem.val(i).change()):(n=r.elem.attr("min"),r.elem.val(null!=n&&t.isNumber(n)?n:"0").change()))},t.elemBtnMousedownHandler=function(n){var t,i,r,o;i=n.data.p,t=n.data.func,i[t](),o=function(e){return function(e){i[t](),i.timeoutID=window.setTimeout(o,10)}}(this),r=function(n){return function(t){window.clearTimeout(i.timeoutID),e(document).off("mouseup",r),e(n).off("mouseleave",r)}}(this),e(document).on("mouseup",r),e(this).on("mouseleave",r),i.timeoutID=window.setTimeout(o,700)},t.prototype.attrMutationHandler=function(e,n,t){var i,r,o,s,u,a;if("class"===e||"style"===e){for(r={},i=null,a=["opacity","visibility","-moz-transition-property","-moz-transition-duration","-moz-transition-timing-function","-moz-transition-delay","-webkit-transition-property","-webkit-transition-duration","-webkit-transition-timing-function","-webkit-transition-delay","-o-transition-property","-o-transition-duration","-o-transition-timing-function","-o-transition-delay","transition-property","transition-duration","transition-timing-function","transition-delay"],s=0,u=a.length;u>s;s++)o=a[s],(i=this.elem.css(o))!==this.btnContainer.css(o)&&(r[o]=i);"none"===this.elem.css("display")?r.display="none":r.display="inline-block",this.btnContainer.css(r)}else("min"===e||"max"===e||"step"===e)&&this.elem.change()},t.prototype.increment=function(){var e,n;this.elem.is(":disabled")||this.elem.is("[readonly]")||(n=this.getParams(),e=t.preciseAdd(n.val,n.step),null!=n.max&&parseFloat(e)>parseFloat(n.max)&&(e=n.max),e=this.stepNormalize(e),this.elem.val(e).change())},t.prototype.decrement=function(){var e,n;this.elem.is(":disabled")||this.elem.is("[readonly]")||(n=this.getParams(),e=t.preciseSubtract(n.val,n.step),null!=n.min&&parseFloat(e)<parseFloat(n.min)&&(e=n.min),e=this.stepNormalize(e),this.elem.val(e).change())},void e(function(){e('input[type="number"]').inputNumber()})):void(e.fn.inputNumber=function(){return e(this)})}(jQuery)}).call(this);